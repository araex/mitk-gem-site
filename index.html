<!doctype html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <title>MITK-GEM</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16" />
        <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:400,700">

        <script src="js/jquery-1.11.1.min.js"></script>
        <script src="js/lightbox.min.js"></script>

        <!-- build:css css/main.css -->
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/base.css">
        <link rel="stylesheet" href="css/utils.css">
        <link rel="stylesheet" href="css/components.css">
        <link rel="stylesheet" href="css/site.css">
        <link rel="stylesheet" href="css/mq.css">
        <link rel="stylesheet" href="css/print.css">
        <link rel="stylesheet" href="css/font-awesome-4.5.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="css/lightbox.css"/>
        <!-- endbuild -->

    </head>
    <body>
        <div class="site-header-container">
            <div class="site-header clearfix" role="banner">
                <div class="site-logo">
                    <a href="#home" class="white">MITK <i class="fa fa-diamond fa-lg hiColor"></i> GEM</a>
                </div>
                <ul class="site-nav inline-block-list hiColor">
                    <li><a href="#features" class="hiColor">Features</a></li>
                    <li><a href="#tutorial" class="hiColor">Tutorials</a></li>
                    <li><a href="#faq" class="hiColor">FAQ</a></li>
                    <li><a href="#about" class="hiColor">About</a></li>
                </ul>
            </div>
        </div><!-- end site-header -->

        <a class="anchor" id="home"></a>
        <div class="container">
            <div class="site-promo">
                <h1>MITK - <span class="hiColor">GE</span>nerate <span class="hiColor">M</span>odels</h1>
                <p class="description">MITK-GEM is a free open-source software pipeline to generate finite element models from image data. MITK-GEM is built on top of the Medical Imaging Interaction Toolkit (MITK) Workbench.</p>

                <div class="cta-option">
                    <a class="btn btn-download" href="https://simtk.org/project/xml/downloads.xml?group_id=1063">
                        <strong><i class="fa fa-download"></i> Download</strong>
                    </a>
                </div>

                <div class="cta-option">
                    <a class="btn btn-alt" href="https://github.com/araex/mitk-gem">
                        <i class="fa fa-github"></i> Source code
                    </a>
                </div>
            </div><!-- end site-promo -->
        </div>

        <a class="anchor" id="features"></a>
        <div class="site-section">
            <div class="container">
                <article>
                    <h2>Features</h2>
                    <p class="justify-text">
                    MITK-GEM implements all its features as plugins for the <a href="http://mitk.org/" class="extA">Medical Imaging Interaction Toolkit (MITK)</a> Workbench. It expands the MITK Workbench by offering a finite element model generation workflow with the following steps:
                    </p>
                    <ul class="justify-text">
                        <a href="#graphcut"><li>Interactive image segmentation with 3D Graphcuts<span><img class="icon" src="img/graphcut.png" alt="Icon GraphCut Plugin"></span>.</li></a>
                        <a href="#surfacemesh"><li>Surface mesh generation<img class="icon" src="img/voxel2mesh.png" alt="Icon SurfaceMesh Plugin"></span>.</li></a>
                        <a href="#volumemesh"><li>Tetrahedral mesh generation<img class="icon" src="img/volumemesh.png" alt="Icon GraphCut Plugin"></span>.</li></a>
                        <a href="#materialmapping"><li>Highly configurable material mapping procedure<img class="icon" src="img/materialmapping.png" alt="Icon GraphCut Plugin"></span>.</li></a>
                    </ul>
                </article>

                <article>
                    <h2>Application overview</h2>
                    <p>
                        <a href="img/Overview.png" data-lightbox="overview" data-title="MITK-GEM overview">
                            <img src="img/Overview.png" alt="Workbench overview">
                        </a>
                        <ol class="justify-text">
                            <li>The Data Manager<span><img class="icon" src="img/datamanager.png" alt="Icon DataManager Plugin"></span>contains all loaded data (images, surfaces, meshes) as well as the results produced by the plugins. You can save your results from here by right clicking on them and selecting save.</li>
                            <li>The toolbar containing all available plugins. Open a plugin by clicking on it.</li>
                            <li>The view of the currently opened plugin.</li>
                        </ol>
                    </p>
                </article>
            </div>
        </div> <!-- end section-download -->

        <a class="anchor" id="tutorial"></a>
        <div class="site-section site-section-example">
            <div class="container">
                <h1>Tutorials</h1>
                <a class="anchor" id="graphcut"></a>
                <article>
                  <h2>Graphcut segmentation</h2>
                  <p>
                    <div>
                        <video controls width="100%" height="auto" poster="video/thumbnail.png">
                         <source src="video/3dgraphcut_demo.mp4">
                         <!-- <source src="video/MITKGraphCutSegmentationDemo_v2.webm"> -->
                         <p class="no-video">To view this video, please install a browser that <a href="http://caniuse.com/#feat=video">supports HTML5 video.</a></p>
                        </video>
                    </div>
                    <ol class="justify-text">
                        <li>Open the image you want to segment.</li>
                        <li>Switch to the Segmentation Plugin<span><img class="icon" src="img/segmentation.png" alt="Icon Segmentation Plugin"></span>and create a new mask for the background.</li>
                        <li>Pick the Paint Tool and set a brush size. </li>
                        <li>Mark the area that you consider background. Doing this on one slice should be sufficient.</li>
                        <li>Repeat for foreground.</li>
                        <li>Switch to the GraphCut3D Plugin<span><img class="icon" src="img/graphcut.png" alt="Icon GraphCut Plugin"></span>.</li>
                        <li>Check that all images are set correctly and adjust the parameters to your needs.</li>
                        <li>Click the 'Start' button and wait for it to finish.</li>
                        <li>Once finished, a new segmentation called 'graphcut segmentation' will appear in the Data Manager<span><img class="icon" src="img/datamanager.png" alt="Icon DataManager Plugin"></span>. You can right click it to save it on your disk or proceed with the surface mesh generation.</li>
                    </ol>
                  </p>
                </article>

                <a class="anchor" id="surfacemesh"></a>
                <article>
                    <h2>Surface mesh generation</h2>
                    <p>
                      <p class="justify-text">The Surface Mesher allows the conversion of binary masks to surface meshes using a marching cubes algorithm. A binary mask is an image with background values of 0 and foreground values of 255.
                      </p>
                      <a href="img/screen_voxel2mesh.png" data-lightbox="tutorial" data-title="Surface mesher plugin">
                          <img src="img/screen_voxel2mesh.png" alt="Screenshot surface mesh plugin" style="max-width: 423px">
                      </a>
                      <ol class="justify-text">
                        <li>Select a mask in the Data Manager<span><img class="icon" src="img/datamanager.png" alt="Icon DataManager Plugin"></span>.</li>
                        <li>The mask will get passed down through all the steps represented by the group boxes: Median filter -> Gaussian smoothing -> Marching cubes -> Polygon smoothing. You can enable or disable a step by clicking the checkbox next to its title. </li>
                        <li>Adjust the settings to match your requirements. The default settings should give accurate results in most cases.</li>
                        <li>After pressing the "Generate surface" button, the mask will get processed and the resulting surface will be added to your Data Manager<span><img class="icon" src="img/datamanager.png" alt="Icon DataManager Plugin"></span>.
                      </ol>
                      <p class="justify-text">Note: To generate a closed surface, make sure the mask does not extend to the border of the image. You can use the padding plugin<span><img class="icon" src="img/padding.png" alt="Icon Padding Plugin"></span>to add empty slices.</p>
                    </p>
                </article>

                <a class="anchor" id="volumemesh"></a>
                <article>
                  <h2>Tetrahedral mesh generation</h2>
                  <p>
                    <p class="justify-text">Using the Volume Mesher plugin, you can create volumetric (tetrahedral) meshes from surfaces. The meshing is done by <a href="http://wias-berlin.de/software/tetgen/" class="extA">tetgen</a>. The results are represented as unstructured grids (.vtu). Visualization of unstructured grids is currently disabled, to inspect the results, use a tool such as <a href="http://www.paraview.org/" class="extA">paraview</a>.
                    </p>
                    <a href="img/screen_volumemesh.png" data-lightbox="tutorial" data-title="Volume mesher plugin">
                        <img src="img/screen_volumemesh.png" alt="Screenshot volume mesh generation" style="max-width: 534px">
                    </a>
                    <ol class="justify-text">
                      <li>Load a surface mesh and select it with the drop down box. Make sure the surface is closed.</li>
                      <li>Since the volume mesher is a front end to <a href="http://wias-berlin.de/software/tetgen/" class="extA">tetgen</a>, so the settings directly correspond to the ones available in tetgen.</li>
                      <li>Press "Generate tetrahedral mesh" to start the process. The resulting unstructured grid will be stored in the Data Manager<span><img class="icon" src="img/datamanager.png" alt="Icon DataManager Plugin"></span>. </li>
                    </ol>
                  </p>
                </article>

                <a class="anchor" id="materialmapping"></a>
                <article>
                  <h2>Material mapping</h2>
                  <p>
                    <p class="justify-text">The material mapping plugin is used to assign material properties to a volume mesh from image voxel values. The plugin determines for each node in a volumetric mesh the corresponding gray scale value in the image. Through a series of conversion steps, gray scale values in Hounsfield units are converted to bone density and finally to elastic modulus using a power law. The plugin supports this workflow and produces a volumetric mesh represented as an unstructured grid (.vtu) with elastic modulus assigned to each node and element. The unstructured grid can subsequently be converted to FE solver compatible formats using conversion scripts (examples provided). For more information refer to our <a href="https://simtk.org/project/xml/publications.xml/?group_id=1063" class="extA">paper</a>.
                    </p>
                    <a href="img/screen_calibration.png" data-lightbox="tutorial" data-title="Material mapping calibration">
                        <img src="img/screen_calibration.png" alt="Screenshot bone density calibration" style="max-width: 463px">
                    </a>
                    <ol class="justify-text">
                      <li>Load an unstructured grid and a grayscale image and select them with the drop down boxes.</li>
                      <li>Enter the bone density calibration values for your phantom into the table. The calibration unit can be set using the dropdown box.
                        <br/>To obtain calibrator values, use the Measurement Plugin<span><img class="icon" src="img/measurement.png" alt="Icon Measurement Plugin"></span> to select a 2D region with in the calibrator and the Statistics Plugin <span><img class="icon" src="img/ImageStatistic_24.png" alt="Icon Statistics Plugin"></span> to determine the corresponding average value. Repeat for multiple slices along the calibrator and calculate average. Alternatively, a full segmentation in 3D of the calibrator with the can be obtained with the Segmentation Plugin <img class="icon" src="img/segmentation.png" alt="Icon Segmentation Plugin"> and the average value can be obtained by selecting image and calibrator mask and enabling the Statistics plugin.
                        <br/>If you already know your equation for Bone density &rho;, you can disable the calibration using the "Phantom calibration for &rho;_ct" checkbox and enter it directly below.</li>
                        <li>Note that after the calibration all steps will use gHA/cm³ regardless of your chosen calibration unit! Conversion happens automatically if necessary.</li>
                    </ol>

                    <a href="img/screen_calibration2.png" data-lightbox="tutorial" data-title="Material mapping bone density parameters">
                        <img src="img/screen_calibration2.png" alt="Screenshot bone density calibration 2" style="max-width: 463px">
                    </a>
                    <ol class="justify-text">
                      <li value="4">A linear equation for bone mineral density &rho;_ct will get fitted to your calibration using a least squares fitting technique. </li>
                      <li>The final bone density value &rho;_app used for further steps is obtained in 3 steps as reported in the literature: (1) HU -> &rho;_ct (2) &rho;_ct -> &rho;_ash  (3) &rho;_ash -> &rho;_app.</li>
                    </ol>

                    <a href="img/screen_calibration3.png" data-lightbox="tutorial" data-title="Material mapping power laws">
                        <img src="img/screen_calibration3.png" alt="Screenshot bone density calibration 3" style="max-width: 463px">
                    </a>
                    <ol class="justify-text">
                      <li value="6">Specify the power laws that should be applied to your bone density.</li>
                      <li>Using the "add" button, you can add additional power laws with a corresponding interval.</li>
                      <li>Press the "Start" button to start the material mapping. The resulting unstructured grid will have an additional point and cell array containing the material properties.</li>
                      <li>Save the unstructured grid as .vtu (right click in data manager -> save as).</li>
                      <li>Convert the unstructured grid to the FE model format of your choice. Some converter scripts are provided here.</li>
                    </ol>
                    <h1 class="hiColor">TODO: add link to converter scripts.</h1>
                  </p>
                </article>


            </div>
        </div> <!-- end section-tutorial -->

        <a class="anchor" id="faq"></a>
        <div class="site-section">
            <div class="container">
                <article>
                    <h2>Frequently Asked Questions</h2>
                    <div class="faq">
                        <input type="checkbox" id="q1">
                        <label for="q1">Can i use this tool for diagnosis and treatment?</label>
                        <div class="faq-content">
                            <p>No, MITK-GEM is for research only.</p>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q2">
                        <label for="q2">Can i use this tool for my research?</label>
                        <div class="faq-content">
                            <p>Yes, MITK-GEM is released under the GPLv3 license and you may use it under these terms. If you do use it, please <a href="https://simtk.org/project/xml/publications.xml/?group_id=1063" class="extA">cite the paper</a>.</p>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q13">
                        <label for="q13">Under what license is MITK-GEM released?</label>
                        <div class="faq-content">
                            <p>MITK-GEM as a tool is released under the GPLv3 license. However, the plugins are individually licensed and may be used under these conditions separately:
                            <ul>
                                <li>Material Mapping: BSD 3-Clause License.</li>
                                <li>Surface Mesher: BSD 3-Clause License</li>
                                <li>Resample Plugin: BSD 3-Clause License</li>
                                <li>Padding Plugin: BSD 3-Clause License</li>
                                <li>GraphCut3D: GPLv3 because of the used library <a href="https://pub.ist.ac.at/~vnk/software.html" class="extA">maxflow</a>.</li>
                                <li>Volume Mesher: GPLv3 beaucse of the used library <a href="http://wias-berlin.de/software/tetgen/" class="extA">tetgen</a>.</li>
                            </ul>
                            For more details, see the LICENSE.txt in the respective plugins source code folder.</p>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q14">
                        <label for="q14">I get an Error: This application failed to start because it could not find or load the Qt platform plugin "xcb"</label>
                        <div class="faq-content">
                            <p>On linux, the enviroment variable QT_PLUGIN_PATH has to be set to point to the Qt5 plugins directory in order to start MITK-GEM. Example: </p>
                            <div class="code-snippet">
                                <pre>
bash:~/$ export QT_PLUGIN_PATH=/usr/lib/x86_64-linux-gnu/qt5/plugins
                                </pre>
                            </div>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q3">
                        <label for="q3">What is a .matmap file?</label>
                        <div class="faq-content">
                            <p>The material mapping plugin allows you to export the current parametrization to a .matmap file. The file uses the XML markup language and can be opened with any text editor. An example of a .matmap file is given below.</p>
                            <div class="code-snippet">
                                <pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;MaterialMapping Version=&quot;2016.2&quot;&gt;
    &lt;Calibration unit=&quot;mgHA/cm&#179;&quot;&gt;
        &lt;DataPoint HU=&quot;1.79&quot; rho=&quot;0&quot; /&gt;
        &lt;DataPoint HU=&quot;88.200000000000003&quot; rho=&quot;75&quot; /&gt;
        &lt;DataPoint HU=&quot;174.360000000000014&quot; rho=&quot;150&quot; /&gt;
    &lt;/Calibration&gt;
    &lt;BoneDensityParameters&gt;
        &lt;RhoCT AutomaticFit=&quot;1&quot; slope=&quot;0&quot; offset=&quot;0&quot; /&gt;
        &lt;RhoAsh enabled=&quot;1&quot; offset=&quot;0&quot; divisor=&quot;1&quot; /&gt;
        &lt;RhoApp enabled=&quot;1&quot; divisor=&quot;0&quot; /&gt;
    &lt;/BoneDensityParameters&gt;
    &lt;PowerLaws&gt;
        &lt;PowerLawParameters factor=&quot;1&quot; exponent=&quot;1&quot; offset=&quot;0&quot; rangeMin=&quot;-3.40282346638529e+38&quot; rangeMax=&quot;0&quot; /&gt;
        &lt;PowerLawParameters factor=&quot;6850&quot; exponent=&quot;1.49&quot; offset=&quot;0&quot; rangeMin=&quot;0&quot; rangeMax=&quot;-3.40282346638529e+38&quot; /&gt;
    &lt;/PowerLaws&gt;
    &lt;Options doPeel=&quot;1&quot; numberOfExtends=&quot;3&quot; minValue=&quot;0&quot; /&gt;
&lt;/MaterialMapping&gt;
                                </pre>
                            </div>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q12">
                        <label for="q12">Can i load a calibration from a file?</label>
                        <div class="faq-content">
                            <p>Yes, you can provide a partially defined .matmap file including only the calibration element: </p>
                            <div class="code-snippet">
                                <pre>
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;MaterialMapping Version=&quot;2016.2&quot;&gt;
    &lt;Calibration unit=&quot;mgHA/cm&#179;&quot;&gt;
        &lt;DataPoint HU=&quot;1.79&quot; rho=&quot;0&quot; /&gt;
        &lt;DataPoint HU=&quot;88.200000000000003&quot; rho=&quot;75&quot; /&gt;
        &lt;DataPoint HU=&quot;174.360000000000014&quot; rho=&quot;150&quot; /&gt;
    &lt;/Calibration&gt;
&lt;/MaterialMapping&gt;
                                </pre>
                            </div>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q4">
                        <label for="q4">What does the 'Required Memory' field in the Graphcut3D plugin mean?</label>
                        <div class="faq-content">
                            <p>The graphcut algorithm requires large amounts of memory to build the necessary graph. This field tells you exactly how much memory the graph and the image data will allocate. It is highly recommended that you have at least this much free memory before starting the computation. If you do not have enough memory, see FAQ Section "I have less memory than 'Required memory'" for workarounds. </p>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q5">
                        <label for="q5">I have less memory than 'Required memory'.</label>
                        <div class="faq-content">
                        <p>Not having enough memory will increase the computation time drastically and can even result in a crash of the application. Options at this point are: </p>
                            <ul>
                                <li>Crop the image to only contain the region of interest with the included image cropper plugin<span><img class="icon" src="img/crop.png" alt="Icon Crop Plugin"></span>.</li>
                                <li>Downsample the image using the included resample plugin<span><img class="icon" src="img/resample.png" alt="Icon Resample Plugin"></span>.</li>
                                <li>Create all the masks in the MITK Workbench and save them to your harddisk, then use the Command Line Segmentation Tool to do the computation. The CLI Tool is more memory efficient and is able to complete computations that the plugin can not. However, the computation times will still be very long. </li>
                            </ul>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q6">
                        <label for="q6">The Graphcut3D plugin takes very long for its computation.</label>
                        <div class="faq-content">
                            <p>The 'estimated time' is based on test results on one of our machines. Depending on your hardware, your results may vary. Especially if your machine is not able to store the complete graph in memory, the computation time will increase dramatically.</p>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q7">
                        <label for="q7">The application crashes when i click 'Start' in the Graphcut3D plugin.</label>
                        <div class="faq-content">
                            <p>This is a problem when the plugin tries to allocate more memory than your machine can handle. Please refer to the FAQ section "I have less memory than 'Required memory'" for information on how to decrease the memory usage.</p>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q8">
                        <label for="q8">How do i use the Command Line Segmentation Tool?</label>
                        <div class="faq-content">
                            <p> The standalone application uses a command line interface (CLI) instead of a graphical user interface. Usage requires basic knowledge of your operating systems terminal enviroment.</p>
                        <ol class="justify-text">
                            <li> <a href="#home">Download</a> the Segmentation Tool </li>
                            <li> Unzip the downloaded archive into a folder</li>
                            <li> Start a terminal and navigate to the unziped folder</li>
                            <li> Perform a graph-cut segmentation on the included data: </li>
                        </ol>
                        <div class="code-snippet">
                            <pre>
$ ./GraphCutSegmentation data/input.mhd data/foreground.mhd data/background.mhd data/output.mhd 50 0 1 </pre>
                        </div>
                        You can get additional information about the usage of the program by typing:
                        <div class="code-snippet">
                            <pre>
$ ./GraphCutSegmentation --help

Required: image foreground background output sigma boundaryDirection
image:               3D image in Hounsfield Units -1024 to 3071
foreground:          3D image non-zero pixels indicating foreground and 0 elsewhere
background:          3D image non-zero pixels indicating background and 0 elsewhere
output:              3D image resulting segmentation
sigma:               estimated noise in boundary term, try 50.0
boundaryDirection:   0-&gt;bidirectional; 1-&gt;bright to dark; 2-&gt;dark to bright
</pre>
                        </div>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q9">
                        <label for="q9">I have problems building the application from the source code.</label>
                        <div class="faq-content">
                            <p>There's a seperate FAQ for building over <a href="https://github.com/araex/mitk-gem/blob/master/README.md">here</a>.</p>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q10">
                        <label for="q10">When starting the tool, i get a "undefined symbol: _ZN19QAbstractProxyModel11setItemData" error.</label>
                        <div class="faq-content">
                            <p>This error occurs on systems with a installed QT version older than 4.8. Please update your QT version.</p>
                        </div>
                    </div>
                    <div class="faq">
                        <input type="checkbox" id="q11">
                        <label for="q11">I can't see those sidebars shown in the screenshots and videos.</label>
                        <div class="faq-content">
                            <p>You have to open the plugins by clicking on their icons: <img class="icon" src="img/graphcut.png" alt="Icon GraphCut Plugin"> and <img class="icon" src="img/segmentation.png" alt="Icon Segmentation Plugin">.</p>
                            <a href="img/Screenshot_full.png" data-lightbox="Screenshot_full" data-title="Overview">
                                <img src="img/Screenshot_small.png" alt="Workbench overview">
                            </a>
                        </div>
                    </div>

                    <div class="faq">
                        <input type="checkbox" id="q15">
                        <label for="q15">How to create a closed surface.</label>
                        <div class="faq-content">
                            <p>Because the surface mesher plugin<img class="icon" src="img/voxel2mesh.png" alt="Icon SurfaceMesh Plugin"></span> uses the marching cubes algorithm, it produces open meshes when the mask extends to the border of the image. One way to work around this is to add an empty slice using the padding plugin<span><img class="icon" src="img/padding.png" alt="Icon Padding Plugin"></span>.</p>

                        </div>
                    </div>



                </article>
            </div>
        </div> <!-- end section-faq -->

        <a class="anchor" id="about"></a>
        <div class="site-section site-section-example">
            <div class="container">
                <article>
                    <h2>About</h2>
                    <p class="center-text">
                        For further information and contact details please refer to our <a href="https://simtk.org/home/mitk-gem" class="extA">simtk project</a>.
                    </p>
                </article>
            </div>
        </div> <!-- end section-about -->

    </body>
</html>
